rename(mat_tree = Tree),
by="mat_tree") %>%
select(Tree, mat_tree, Confidence, child_x, child_y, X, Y) %>%
rename(mat_x = X, mat_y = Y)
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.9)
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.8)
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.85)
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.8)
confident_pat_pairwise_coords <- all_pairwise_w_coords %>%
filter(pat_confidence > 0.8 | mat_confidence)
confident_pat_pairwise_coords <- all_pairwise_w_coords %>%
filter(pat_confidence > 0.9 | mat_confidence)
confident_pat_pairwise_coords <- all_pairwise_w_coords %>%
filter(pat_confidence > 0.9 | mat_confidence)
# reworking the map area so it is surrounding the confident stuff
confident_map_area <- get_stamenmap(bbox=c(
left = min(confident_pat_pairwise_coords$child_x - 0.003),
bottom = min(confident_pat_pairwise_coords$child_y - 0.003),
right = max(confident_pat_pairwise_coords$child_x + 0.003),
top = max(confident_pat_pairwise_coords$child_y + 0.003)),
zoom = 14,
maptype = 'terrain')
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.9)
ggmap(map_area) +
geom_segment(all_pairwise_w_coords,
mapping=aes(x=child_x, y=child_y, xend=mat_x, yend=mat_y),
arrow = arrow(length = unit(0.006, "npc"))) +
geom_segment(all_pairwise_w_coords,
mapping=aes(x=child_x, y=child_y, xend=pat_x, yend=pat_y),
arrow = arrow(length = unit(0.006, "npc")))
# reworking the map area so it is surrounding the confident stuff
confident_map_area <- get_stamenmap(bbox=c(
left = min(confident_pat_pairwise_coords$child_x - 0.003),
bottom = min(confident_pat_pairwise_coords$child_y - 0.003),
right = max(confident_pat_pairwise_coords$child_x + 0.003),
top = max(confident_pat_pairwise_coords$child_y + 0.003)),
zoom = 14,
maptype = 'terrain')
confident_pat_pairwise_coords <- all_pairwise_w_coords %>%
filter(pat_confidence > 0.9 | mat_confidence)
confident_pat_pairwise_coords <- all_pairwise_w_coords %>%
filter(pat_confidence > 0.9 | mat_confidence > 0.9)
confident_pat_pairwise_coords <- all_pairwise_w_coords %>%
filter(pat_confidence > 0.9)
ggmap(map_area) +
geom_segment(all_pairwise_w_coords,
mapping=aes(x=child_x, y=child_y, xend=mat_x, yend=mat_y),
arrow = arrow(length = unit(0.006, "npc"))) +
geom_segment(all_pairwise_w_coords,
mapping=aes(x=child_x, y=child_y, xend=pat_x, yend=pat_y),
arrow = arrow(length = unit(0.006, "npc")))
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.9)
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.9)
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.8)
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.85)
confident_pat_pairwise_coords <- pat_pairwise_w_coords %>%
filter(pat_confidence > 0.9)
confident_pat_pairwise_coords <- pat_pairwise_w_coords %>%
filter(pat_confidence > 0.85)
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5)
# reworking the map area so it is surrounding the confident stuff
confident_map_area <- get_stamenmap(bbox=c(
left = min(confident_pat_pairwise_coords$child_x - 0.003),
bottom = min(confident_pat_pairwise_coords$child_y - 0.003),
right = max(confident_pat_pairwise_coords$child_x + 0.003),
top = max(confident_pat_pairwise_coords$child_y + 0.003)),
zoom = 14,
maptype = 'terrain')
# reworking the map area so it is surrounding the confident stuff
confident_map_area <- get_stamenmap(bbox=c(
left = min(confident_pat_pairwise_coords$child_x - 0.003),
bottom = min(confident_pat_pairwise_coords$child_y - 0.003),
right = max(confident_pat_pairwise_coords$child_x + 0.003),
top = max(confident_pat_pairwise_coords$child_y + 0.003)),
zoom = 14,
maptype = 'terrain')
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5)
confident_mat_pairwise_coords <- mat_pairwise_w_coords %>%
filter(Confidence > 0.8)
confident_pat_pairwise_coords <- pat_pairwise_w_coords %>%
filter(pat_confidence > 0.8)
# reworking the map area so it is surrounding the confident stuff
confident_map_area <- get_stamenmap(bbox=c(
left = min(confident_pat_pairwise_coords$child_x - 0.003),
bottom = min(confident_pat_pairwise_coords$child_y - 0.003),
right = max(confident_pat_pairwise_coords$child_x + 0.003),
top = max(confident_pat_pairwise_coords$child_y + 0.003)),
zoom = 14,
maptype = 'terrain')
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5)
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_point(all_pairwise_w_coords, mapping=aes(child_x, child_y))
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_point(confident_pat_pairwise_coords, mapping=aes(child_x, child_y))
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_point(confident_pat_pairwise_coords, mapping=aes(child_x, child_y)) +
geom_point(confident_Mat_pairwise_coords, mapping=aes(child_x, child_y))
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_point(confident_pat_pairwise_coords, mapping=aes(child_x, child_y)) +
geom_point(confident_Mat_pairwise_coords, mapping=aes(child_x, child_y))
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_point(confident_pat_pairwise_coords, mapping=aes(child_x, child_y)) +
geom_point(confident_mat_pairwise_coords, mapping=aes(child_x, child_y))
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_point(confident_pat_pairwise_coords, mapping=aes(child_x, child_y), size = 0.5) +
geom_point(confident_mat_pairwise_coords, mapping=aes(child_x, child_y), size = 0.5)
# map with arrows
ggmap(confident_map_area) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_point(coords, mapping=aes(X, Y), size = 0.5)
# map with arrows
ggmap(confident_map_area) +
geom_point(coords, mapping=aes(X, Y), size = 0.5) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5)
# map with arrows
ggmap(confident_map_area) +
geom_point(geno_coords, mapping=aes(X, Y), size = 0.5) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=.5)
# map with arrows
ggmap(confident_map_area) +
geom_point(geno_coords, mapping=aes(X, Y), size = 0.5) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=1) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=1)
# reworking the map area so it is surrounding the confident stuff
confident_map_area <- get_stamenmap(bbox=c(
left = min(confident_pat_pairwise_coords$child_x - 0.003),
bottom = min(confident_pat_pairwise_coords$child_y - 0.003),
right = max(confident_pat_pairwise_coords$child_x + 0.003),
top = max(confident_pat_pairwise_coords$child_y + 0.003)),
zoom = 15,
maptype = 'terrain')
# map with arrows
ggmap(confident_map_area) +
geom_point(geno_coords, mapping=aes(X, Y), size = 0.5) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=1) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=1)
# reworking the map area so it is surrounding the confident stuff
confident_map_area <- get_stamenmap(bbox=c(
left = min(confident_pat_pairwise_coords$child_x - 0.003),
bottom = min(confident_pat_pairwise_coords$child_y - 0.003),
right = max(confident_pat_pairwise_coords$child_x + 0.003),
top = max(confident_pat_pairwise_coords$child_y + 0.003)),
zoom = 14,
maptype = 'terrain')
# map with arrows
ggmap(confident_map_area) +
geom_point(geno_coords, mapping=aes(X, Y), size = 0.5) +
geom_segment(confident_mat_pairwise_coords,
mapping=aes(x=mat_x, y=mat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=1) +
geom_segment(confident_pat_pairwise_coords,
mapping=aes(x=pat_x, y=pat_y, xend=child_x, yend=child_y,
color=Tree),
arrow = arrow(
length = unit(0.01, "npc"),
type = "closed",
angle = 20),
size=1)
library(tidyverse)
library(tidyverse)
head(genotypes)
franz_genotypes <- genotypes %>% select(-`Sample id`)
franz_genotypes
head(genotypes)
genotypes$Tree
franz_genotypes %>% mutate(Tree = paste(Tree, "      ", sep = ""))
franz_genotypes <- genotypes %>%
select(-`Sample id`) %>%
mutate(Tree = paste(Tree, "      ", sep = ""))
franz_genotypes
library(skimr)
skim(franz_genotypes)
str_length(franz_genotypes$Tree)
franz_genotypes <- genotypes %>%
select(-`Sample id`) %>%
mutate(Tree = paste(Tree, "    ", sep = ""))
str_length(franz_genotypes$Tree)
franz_genotypes <- genotypes %>%
select(-`Sample id`) %>%
mutate(Tree = paste("    ", Tree, sep = "")) # adding 4 spaces to match length
str_length(franz_genotypes$Tree)
head(franz_genotypes)
?write_delim
franz_genotypes %>% write_delim('rough-franz-input.txt')
franz_genotypes %>% write_delim('rough-franz-input.txt', delim = " ")
franz_genotypes <- genotypes %>%
select(-`Sample id`) %>%
mutate(Tree = paste("    ", Tree, " 1 ? ? ?", sep = ""))
franz_genotypes %>% write_delim('rough-franz-input.txt', delim = " ")
head(franz_genotypes)
namese(franz_genotypes)
names(franz_genotypes)
franz_genotypes_slashes <- franz_genotypes %>%
mutate(
yb01 = paste(`yb01 Allele#1`, `yb01 Allele#2`, delim="/"),
yb15 = paste(`yb15 Allele#1`, `yb15 Allele#2`, delim="/"),
yb21 = paste(`yb21 Allele#1`, `yb21 Allele#2`, delim="/"),
yb04 = paste(`yb04 Allele#1`, `yb04 Allele#2`, delim="/"),
yb06 = paste(`yb06 Allele#1`, `yb06 Allele#2`, delim="/"),
yb12 = paste(`yb12 Allele#1`, `yb12 Allele#2`, delim="/"),
yb13 = paste(`yb13 Allele#1`, `yb13 Allele#2`, delim="/"),
fil36 = paste(`fil36 Allele#1`, `fil36 Allele#2`, delim="/"),
yb08 = paste(`yb08 Allele#1`, `yb08 Allele#2`, delim="/"),
yb22 = paste(`yb22 Allele#1`, `yb22 Allele#2`, delim="/")
)
franz_genotypes_slashes
names(franz_genotypes_slashes)
franz_genotypes_slashes %>% select("Tree","yb01","yb15","yb21","yb04","yb06","yb12","yb13","fil36","yb08","yb22")
franz_genotypes_slashes <- franz_genotypes %>%
mutate(
yb01 = paste(`yb01 Allele#1`, "/", `yb01 Allele#2`, delim=""),
yb15 = paste(`yb15 Allele#1`, "/", `yb15 Allele#2`, delim=""),
yb21 = paste(`yb21 Allele#1`, "/", `yb21 Allele#2`, delim=""),
yb04 = paste(`yb04 Allele#1`, "/", `yb04 Allele#2`, delim=""),
yb06 = paste(`yb06 Allele#1`, "/", `yb06 Allele#2`, delim=""),
yb12 = paste(`yb12 Allele#1`, "/", `yb12 Allele#2`, delim=""),
yb13 = paste(`yb13 Allele#1`, "/", `yb13 Allele#2`, delim=""),
fil36 = paste(`fil36 Allele#1`, "/", `fil36 Allele#2`, delim=""),
yb08 = paste(`yb08 Allele#1`, "/", `yb08 Allele#2`, delim=""),
yb22 = paste(`yb22 Allele#1`, "/", `yb22 Allele#2`, delim="")
)
franz_genotypes_slashes %>% select("Tree","yb01","yb15","yb21","yb04","yb06","yb12","yb13","fil36","yb08","yb22")
franz_genotypes_slashes <- franz_genotypes %>%
mutate(
yb01 = paste(`yb01 Allele#1`, ".", `yb01 Allele#2`, delim=""),
yb15 = paste(`yb15 Allele#1`, ".", `yb15 Allele#2`, delim=""),
yb21 = paste(`yb21 Allele#1`, ".", `yb21 Allele#2`, delim=""),
yb04 = paste(`yb04 Allele#1`, ".", `yb04 Allele#2`, delim=""),
yb06 = paste(`yb06 Allele#1`, ".", `yb06 Allele#2`, delim=""),
yb12 = paste(`yb12 Allele#1`, ".", `yb12 Allele#2`, delim=""),
yb13 = paste(`yb13 Allele#1`, ".", `yb13 Allele#2`, delim=""),
fil36 = paste(`fil36 Allele#1`, ".", `fil36 Allele#2`, delim=""),
yb08 = paste(`yb08 Allele#1`, ".", `yb08 Allele#2`, delim=""),
yb22 = paste(`yb22 Allele#1`, ".", `yb22 Allele#2`, delim="")
)
franz_genotypes_slashes %>% select("Tree","yb01","yb15","yb21","yb04","yb06","yb12","yb13","fil36","yb08","yb22")
# okay.. doing it the other way with slash
?paste
franz_genotypes_slashes <- franz_genotypes %>%
mutate(
yb01 = paste(`yb01 Allele#1`, ".", `yb01 Allele#2`, sep=""),
yb15 = paste(`yb15 Allele#1`, ".", `yb15 Allele#2`, sep=""),
yb21 = paste(`yb21 Allele#1`, ".", `yb21 Allele#2`, sep=""),
yb04 = paste(`yb04 Allele#1`, ".", `yb04 Allele#2`, sep=""),
yb06 = paste(`yb06 Allele#1`, ".", `yb06 Allele#2`, sep=""),
yb12 = paste(`yb12 Allele#1`, ".", `yb12 Allele#2`, sep=""),
yb13 = paste(`yb13 Allele#1`, ".", `yb13 Allele#2`, sep=""),
fil36 = paste(`fil36 Allele#1`, ".", `fil36 Allele#2`, sep=""),
yb08 = paste(`yb08 Allele#1`, ".", `yb08 Allele#2`, sep=""),
yb22 = paste(`yb22 Allele#1`, ".", `yb22 Allele#2`, sep="")
)
names(franz_genotypes_slashes)
franz_genotypes_slashes %>% select("Tree","yb01","yb15","yb21","yb04","yb06","yb12","yb13","fil36","yb08","yb22")
franz_genotypes_slashes <- franz_genotypes %>%
mutate(
yb01 = paste(`yb01 Allele#1`, "/", `yb01 Allele#2`, sep=""),
yb15 = paste(`yb15 Allele#1`, "/", `yb15 Allele#2`, sep=""),
yb21 = paste(`yb21 Allele#1`, "/", `yb21 Allele#2`, sep=""),
yb04 = paste(`yb04 Allele#1`, "/", `yb04 Allele#2`, sep=""),
yb06 = paste(`yb06 Allele#1`, "/", `yb06 Allele#2`, sep=""),
yb12 = paste(`yb12 Allele#1`, "/", `yb12 Allele#2`, sep=""),
yb13 = paste(`yb13 Allele#1`, "/", `yb13 Allele#2`, sep=""),
fil36 = paste(`fil36 Allele#1`, "/", `fil36 Allele#2`, sep=""),
yb08 = paste(`yb08 Allele#1`, "/", `yb08 Allele#2`, sep=""),
yb22 = paste(`yb22 Allele#1`, "/", `yb22 Allele#2`, sep="")
)
names(franz_genotypes_slashes)
franz_genotypes_slashes %>% select("Tree","yb01","yb15","yb21","yb04","yb06","yb12","yb13","fil36","yb08","yb22")
franz_genotypes_slashes %>% write_delim('rough-franz-input.txt', delim = " ")
franz_genotypes_slashes %>% write_delim('rough-franz-input-slash.txt', delim = " ")
franz_genotypes_slashes <- franz_genotypes_slashes %>% select("Tree","yb01","yb15","yb21","yb04","yb06","yb12","yb13","fil36","yb08","yb22")
franz_genotypes_slashes %>% write_delim('rough-franz-input-slash.txt', delim = " ")
